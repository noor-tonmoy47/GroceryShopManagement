<!DOCTYPE html>
<html lang="en">

<head>
  <title>Product Purchase</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/Frontend/Logo.png" type="image/icon type">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="invoice.css">
</head>

<body>

  <div class="container">
    <h3 id="headline">Product Purchase</h3>
    <select name="Category" id="Category" onchange="categorySelected()">
      <option value="" style="display: none;"> Category</option>
    </select>

    <select name="Product" id="Product" onchange="productSelected()">
      <option value="" style="display: none;"> Product</option>
    </select>

    <input type="number" id="QuanInput" placeholder="Quantity" name="Quantity" min="0">

    <label for="myText">UnitPrice: </label>
    <input type="text" id="myText" name="myText" readonly>

    <button id="addbtn" onclick="btnSubmit()"> Add </button>
  </div>

  <div class="w3-container">
    <h3 class="short" style="font-size: 23px;">Invoice</h3>

    <table id="invoice">
      <thead>
        <tr>
          <th>Product Name</th>
          <th>Quantity</th>
          <th>Unit Price</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <td colspan="2"></td>
        <td style="font-weight : bold;">Total Payable:</td>
        <td id="total"></td>
      </tbody>
    </table>
  </div>

  <div id="info">
    <button id="pdf" onclick="generateReceipt()"> Generate Receipt </button>
    <button id="checkout" onclick="checkOut()"> checkout </button>
  </div>
  <script src="invoice.js"></script>
  <!-- <script>

    // let transactionID = 7002;


    const filename = 'table-data.pdf';

    function tableToJson(tableId) {
      const table = document.getElementById("invoice");
      const headers = [...table.querySelectorAll('thead th')];
      const rows = [...table.querySelectorAll('tbody tr')];

      const jsonData = rows.map(row => {
        const rowData = {};
        headers.forEach((header, index) => {
          rowData[header.textContent] = row.querySelectorAll('td')[index].textContent;
        });
        return rowData;
      });

      return JSON.stringify(jsonData, null, 2);
    }


    function generateReceipt() {
      const PDFDocument = require('pdfkit');
      const fs = require('fs');
      const doc = new PDFDocument();
      const invoiceJson = tableToJson("myTable");
      // console.log(json);

      // Create a PDF document

      // Pipe the PDF content to a writable stream (a file in this case)
      doc.pipe(fs.createWriteStream(filename));

      // Define table headers
      const headers = ["ProductName", "Quantity", "UnitPrice", "Total"];

      // Add table headers
      headers.forEach(header => {
        doc.fontSize(12).text(header, { continued: true });
        doc.moveUp();
        doc.text("______________", { continued: true });
      });

      doc.moveDown();

      // Loop through and add table data
      invoiceJson.forEach(row => {
        headers.forEach(header => {
          doc.fontSize(12).text(row[header], { continued: true });
        });
        doc.moveDown();
      });

      // Finalize and close the PDF document
      doc.end();



      transactionID++;
    }

  </script> -->

</body>

</html>