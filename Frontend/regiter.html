<!DOCTYPE html>
<html lang="en">

<head>
  <title>Register Product</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/Frontend/Logo.png" type="image/icon type">
  <link rel="stylesheet" href="register.css">
  <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script> -->
</head>

<body>



  <div id="formField">

    <input type="text" class="Register" id="ProductName" name="ProductName" placeholder="Product Name">
    <select name="Category" class="Register" id="Category">
      <option value="hidden" style="display: none;">Category</option>

    </select>
    <select name="Supplier" class="Register" id="SupplierName">
      <option value="hidden" style="display: none;">Supplier</option>

    </select>
    <!-- <input type="text" class="Register" id="SupplierName" name="SupplierName" placeholder="Supplier Name"> -->
    <input type="date" class="Register" id="ExpiryDate" name="ExpiryDate" placeholder="ExpiryDate">
    <input type="number" class="Register" id="numberInput" name="points" placeholder="Quantity" min="0">
    <input type="number" class="Register" id="UnitPrice" name="UnitPrice" placeholder="UnitPrice">

    <button id="RegisterButton"> Register </button>

  </div>




  <div class="ProductArea">
    <div class="containerProducts">
      <h2>Products List</h2>
      <table id='productsTable'>
        <thead>
          <tr>
            <th>ProductsID</th>
            <th>Name</th>
            <th>Category</th>
            <th>Supplier</th>
            <th>ExpiryDate</th>
            <th>Price</th>
          </tr>
        </thead>
        <tbody>

        </tbody>
      </table>
    </div>
  </div>
  <script>

    //Getting the products table
    fetch('http://localhost:3000/api/products', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      },
    }) // Replace with your actual API endpoint
      .then(response => response.json())
      .then(data => {
        const productsTable = document.getElementById('productsTable');
        const tbody = productsTable.querySelector('tbody');

        data.forEach(products => {
          const dateTimeString = products.ExpiryDate;
          let dateOnly;
          if (dateTimeString !== null) {

            dateOnly = new Date(dateTimeString).toISOString().split('T')[0];
          }
          else {
            dateOnly = dateTimeString;
          }
          const row = document.createElement('tr');
          row.innerHTML = `
                                <td>${products.ProductID}</td>
                                <td>${products.Name}</td>
                                <td>${products.Category}</td>
                                <td>${products.Supplier}</td>
                                <td>${dateOnly}</td>
                                <td>${products.Price}</td>
                            `;
          tbody.appendChild(row);

        });
      })
      .catch(error => {
        console.error('Error fetching data: ' + error);
      });


    //getting the suppliers name
    fetch('http://localhost:3000/api/getSupplier', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      },
    }) // Replace with your actual API endpoint
      .then(response => response.json())
      .then(data => {
        const SupplierSelect = document.getElementById('SupplierName');


        data.forEach(supplier => {
          const option = document.createElement('option');

          option.value = supplier.SupplierName;
          option.text = supplier.SupplierName;
          SupplierSelect.appendChild(option);

        });
      })
      .catch(error => {
        console.error('Error fetching data: ' + error);
      });



    //Getting all categories

    fetch('http://localhost:3000/api/getCategory', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      },
    }) // Replace with your actual API endpoint
      .then(response => response.json())
      .then(data => {
        const categorySelect = document.getElementById('Category');


        data.forEach(category => {
          const option = document.createElement('option');

          option.value = category.CategoryName;
          option.text = category.CategoryName;
          categorySelect.appendChild(option);

        });
      })
      .catch(error => {
        console.error('Error fetching data: ' + error);
      });

  </script>
</body>

</html>